---
title: "Assignment 3 - Working with Data & Data Relations"
subtitle: '2030071 - 1753320'
author: "Group 50: Rom√©e Simons and Tycho Brouwer"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: cosmo
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: false
    number_sections: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#the needed packages are: 
library(tidyverse)
library(patchwork)
library(plotly)
library(ggdist)
library(kableExtra)

set.seed(30250) #makes sure random numbers are reproducible

```

# Task 1


```{r, load data}
education_data <- read_delim('education_data.csv', delim=";", show_col_types = FALSE)
```

# Task 2

According to the glimpse function the dataset has 6 columns and 132 rows.

From manually inspecting the data, the column **value** is missing a data for 33 rows.

The period of the data is from 2011 to 2022, the values range from 14380 to 64990, so the range is 50610.

```{r, display data, echo=FALSE}
glimpse(education_data)
```

# Task 3

```{r, rename columns}
education_data <- education_data |>
  rename(
    measure = meAsur3,
    gender_code = gender_coded,
    education_type = EducationType,
    degree_type = degreeType,
    period = Period,
    graduates = VALUE
    )

glimpse(education_data)
```

# Task 4
```{r}
typeof(education_data$measure)
typeof(education_data$gender_code)
typeof(education_data$education_type)
typeof(education_data$degree_type)
typeof(education_data$period)
typeof(education_data$graduates)
```

The columns for the **measure**, **gender code**, **education type**, **degree type**, and **period** are of the type **character**.

The **value** column has a datatype of **double**.

# Task 5

The primary dataset is the data from the **education_data.csv** file.

From both datasets all rows are unique because unique returns the same number of columns.

From the second dataset we want to incorporate the gender column.

```{r}
unique(education_data)
```

# Task 6

```{r, create gender transform table}
gender_code_data = tribble(
  ~gender_code, ~gender,
  "T001038", "Total",
  "3000", "Men",
  "4000", "Women",
  "5000", "Other",
  "6000", "prefer_not_to_say",
)

gender_code_data
```

# Task 7

With the join operation the **gender** column has been added to the dataset. 

Looking again at the missing data points, they are from all years in the dataset where both the education type is **Hoger beroepsonderwijs** and the degree type is **Wo-master**

```{r, join data, message=FALSE}
joined_data = inner_join(education_data, gender_code_data)

glimpse(joined_data)
```

# Task 8

```{r, create tables}
table1 = tribble(
  ~Year, ~Program, ~Value,
  2019, "uni_master", 41710,
  2020, "uni_master", 46810,
  2021, "uni_master", 46870,
)

table2 = tribble(
  ~Year, ~Program, ~Value,
  2018, "uni_master", 40860, 
  2020, "uni_master", 46810,
  2021, "uni_master", 46870,
)

table3 = tribble(
  ~Year, ~`Total people`,
  2018, 17181084,
  2019, 17282163,
  2020, 17407585,
  2021, 17475415,
)
```

table 1:
```{r, echo=FALSE}
kable(table1, align = 'c')
```

table 2:
```{r, echo=FALSE}
kable(table2, align = 'c')
```

table 3:
```{r, echo=FALSE}
kable(table3, align = 'c')
```

# Task 9

Unique combination of table 1 and table 2:

```{r, echo=FALSE}
unionTable = union(table1, table2, )
unionTable |>
  kable(align = 'c')
```

With total people added:

```{r, echo=FALSE}
withTotalTable = bind_cols(unionTable, `Total people` = table3$`Total people`)
withTotalTable |>
  kable(align = 'c')
```

Duplicate rows from table 1 and table 2

```{r, echo=FALSE}
intersectTable = intersect(table1, table2, )
intersectTable |>
  kable(align = 'c')
```

# Task 10

```{r}
education_lvl_data <- read_delim('education_level_data.csv', delim=",", show_col_types = FALSE, skip = 3)

summary(education_lvl_data)
```

# Task 11

```{r, warning=FALSE}
education_lvl_data |>
  ggplot(aes(`year`, `value`, colour = degree)) +
  geom_point() +
  labs(x = 'year of graduation', y = 'number of graduates') +
  ggtitle('Number of graduates in the Netherlands per degree over the years') +
  scale_color_manual(name="Degree", labels = c("HBO Bachelor", "HBO Master", "WO Bachelor", "WO Master"), values = c("blue", "red", "violet", "green"))
```









